IDENTIFICATION DIVISION.
PROGRAM-ID. GetTotal.
AUTHOR. GaMaDeCa.
DATE-WRITTEN. 2025-09-12.
INSTALLATION. Example Corp.

*> Get total from a list of numbers input by the user
DATA DIVISION.
WORKING-STORAGE SECTION.

77 MAX-ITEMS         PIC 9(3) VALUE 100.
77 NUM-ITEMS         PIC 9(3) VALUE 0.
77 TOTAL             PIC 9(7)V99 VALUE 0.
77 I                 PIC 9(3) VALUE 1.
77 USER-INPUT        PIC X(20).

01 NUMBERS.
   05 NUMBER-VALUE OCCURS 100 TIMES INDEXED BY IDX.
	   10 VALUE-ITEM PIC 9(5)V99 VALUE 0.

PROCEDURE DIVISION.
MAIN-LOGIC.
   DISPLAY "How many numbers do you want to sum (max 100)?"
   ACCEPT USER-INPUT
   MOVE FUNCTION NUMVAL(USER-INPUT) TO NUM-ITEMS
   *> Check for errors
   IF NUM-ITEMS > MAX-ITEMS
	   DISPLAY "ERROR! Too many items. Max is 100."
	   STOP RUN
   END-IF
   *> Ask number loop
   PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > NUM-ITEMS
	   DISPLAY "Enter number " IDX ": "
	   ACCEPT USER-INPUT
	   MOVE FUNCTION NUMVAL(USER-INPUT) TO VALUE-ITEM(IDX)
   END-PERFORM
   *> Sum Number Function
   PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > NUM-ITEMS
	   ADD VALUE-ITEM(IDX) TO TOTAL
   END-PERFORM
   
   DISPLAY "The total sum is: " TOTAL
   STOP RUN.